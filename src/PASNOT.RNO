.P
.C
Experience with Swedish Pascal
.C
------------------------------
.P
If you come across something interesting and previously unknown, get a
System Manager to put it in this document for future reference.
.PG
.LS
.LEB;You must specify any of tty,input and output which you wish to use
in brackets after the program statment.  The NBS compiler ignores these
brackets, so on this system nobody has previously bothered
putting them in.
.LEB;When reading in a string, you must first do a readln.  Eg
.S
.C
readln; read(str);
.S
This does not apply to integers, which should be read by read(int);
.LEB; When opening a file using reset, the parameters passed must be as in
the manual.  This has a disadvantage, in that there is no easy way to open
a filename specified by the user if it is on a disk other than SY:.  A
way round this would be to extract the routine which splits up a filename
into its component parts from the compiler.
.LEB;' not " must be used to surround string constants.
.LEB;You cannot declare a constant to be, for example, chr(10).  The way to
do this is to declare it to be 12B - the number is in octal.
.LEB;There is a bug in the compiler which prevents you from using a variable
of higher scope as the index of a for loop (error 155 results).  Use a
while loop instead.  This is annoying !
.S
Later - this is actually not a bug, but a Pascal standard requirement,
dating from about 1979, which explains why CROSS didn't compile.  It's still
annoying !
.S
This is modification 106.  Perhaps it would be possible to edit it back if
we ever get the RSX operating system, which we need to run PAZ on.  At the
moment we can't compile the compiler, so there's nothing we can do about it.
.LEB;Some programs, eg those supplied with the compiler, which specify
output in the program statement, produce a file called OUTPUT. in your account.
Harmless, but annoying at times.
.LEB;The error numbers returned by ioresult are not RSTS error codes, and we
haven't got a copy of the manual to which the Pascal manual refers.  I'll
make a list here as I find them out.
.LS
.LEN;-26 : Can't find file or account.
.LEN;-54 : Illegal file name (?)
.ELS
.S
All those with queries after the message are dubious.
.S
These messages actually correspond to the RSX error codes.
.S
.LEB;Good news for a change - the record I/O features seem to work.  I've
written a test program to store and retrieve records from a file, and it
seems OK.  Note that the first record is numbered 1, as in BASIC.
.P
Some other things to note:
.LS
.LE;If you get some funny errors, when trying to get a record after doing
a put, try resetting the file first.  Remember to specify the right
parameters for reset (ie RANDOM) otherwise it goes really funny.
.LE;I came across this in connection with records, so I'll put it here.
If you try to read a compex-looking variable (eg recfile^.a), it may give
you a funny error.  Try doing read(tty,recfile^.a) instead of read(recfile^.a).
.ELS
.LEB;The cross-referencer program, CROSS, is working as of today (05/07/87).
It produces a pretty-printed version of the program (on SY:, so it may
overwrite your original file - careful!) as well as a .CRL
listing.  See CROSS.MAN.
.S
If you ever need to recompile CROSS, be sure to give it a fairly large EXTTSK
in the TKB stage - I use 11200 - as it uses a lot of dynamic allocation.
The full TKB sequence looks like this:
.S
.LIT
     TKB>cross=cross,pas:paslib/lb
     TKB>/
     Enter Options:
     TKB>exttsk=11200
     TKB>//
.ELI
.S
You may need to reduce this if you compile it R+.
.LE;String parameters to arrays - for variable length see the manual.  If
you want a fixed length string, you'll have to define the array type.  Eg:
.S
.LM +10
TYPE ARAY = ARRAY [1..5] OF CHAR;

PROCEDURE A(VAR Z : ARAY);

.LM -10
.S
For some reason it won't parse it if you say :
.S
.C ;PROCEDURE A(VAR Z : ARRAY [1..5] OF CHAR);
.S
.LEB;The debugger doesn't work, at least yet.  If you try to compile something
with the Debug option set, the compiler goes into an infinite loop when it
encounters a begin statement.
.LEB;The overlaying seems to work - here is an example :
.S
.LIT
{$Y+}

program test(tty);

procedure a;

begin
  writeln('Hello');
end;

procedure b;

begin
  writeln('Hi');
end;

begin
  repeat a; b; until false;
end.
.ELI
.S
Here is the .ODL file :
.S
.LIT
         .PSECT  $99999 RO,D,GBL,OVR
         .ROOT   T1-*(T2,T3),$99999
T1:	.FCTR	T/LB:TEST-LIBR
T2:	.FCTR	T/LB:A-LIBR
T3:	.FCTR	T/LB:B-LIBR
LIBR:	.FCTR	PAS:PASLIB/LB
         .END
.ELI
.S
.LEB;The frequency measurement is working as of today (08/07/87).  The
required PASFQV was not in the supplied PASLIB, but was in PASLIB.PAC.  I
extracted it using SELECT, compiled it and inserted it into PASLIB.  A .FQV
file is produced, though it doesn't seem to take any notice of measuring
points, it just produces statistics on all lines.
.LEB;A version of PAS with slightly improved overlaying and an increased
EXTTSK is now available.  It is called PASBIG, and the CCL points to it.
With a trial program, a speed increase of 33% over the old version was
noticed.
.LEB;CROSS has been modified so that it no longer spools the .CRL file
if OPSER is running.  The line modified is the one which defines IOS.
.LEB;Some problems have been encountered using the eof function in
keyboard input.  You should put the eof after the readln and before
the read (as in the demo below).  If no eof check is made, and a
read is performed, then a runtime error will be encountered.  Here
is an example program :
.S
.LIT
program t2(tty);

var
  ch : char;

begin
  loop
    readln;
    exit if eof(tty);
    read(ch); writeln(ch);
  end;
end.
.ELI
.ELS
.S
.S
.C
Edward Hibbert####25-Mar-88 
.P
