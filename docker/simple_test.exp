#!/usr/bin/expect -f
# Simple test that waits for game output

set timeout 120
log_user 1

spawn nc localhost 2323

expect "Connected"
sleep 3
send "\r"

expect "User:"
send "\[1,2\]\r"

expect -re "\[Pp\]assword"
send "Digital1977\r"

expect {
    "Job number to attach to?" {
        send "\r"
    }
    -re {\$} {}
}

expect -re {\$}

# Run ADVENT
send "RUN ADVENT\r"

# Wait for room description - wait a bit longer
sleep 8

# Try LOOK command
send "LOOK\r"
sleep 5

# Try NORTH
send "NORTH\r"
sleep 5

# Try QUIT
send "QUIT\r"
sleep 3

# Logout
send "\003"
sleep 1
send "BYE\r"

expect eof
