<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADVENT MUD - 1987 Multi-User Dungeon</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- Left side: CRT Terminal -->
        <div class="terminal-wrapper">
            <div class="crt-frame">
                <div class="crt-bezel">
                    <div class="crt-label">DEC VT100</div>
                    <div class="crt-screen">
                        <div class="crt-overlay"></div>
                        <div class="scanline"></div>
                        <iframe id="terminal-frame" src="about:blank"></iframe>
                        <div id="input-blocker" class="input-blocker active"></div>

                        <!-- Connection status overlay ON the monitor -->
                        <div id="connection-overlay" class="connection-overlay active">
                            <div class="overlay-content">
                                <h2>Connecting...</h2>
                                <div class="status-steps">
                                    <div class="step active" id="step-connect">
                                        <span class="step-icon">&#8226;</span>
                                        <span class="step-text">Connecting to PDP-11...</span>
                                    </div>
                                    <div class="step" id="step-boot">
                                        <span class="step-icon">&#9675;</span>
                                        <span class="step-text">Waiting for RSTS/E...</span>
                                    </div>
                                    <div class="step" id="step-login">
                                        <span class="step-icon">&#9675;</span>
                                        <span class="step-text">Logging in as [1,2]...</span>
                                    </div>
                                    <div class="step" id="step-game">
                                        <span class="step-icon">&#9675;</span>
                                        <span class="step-text">Starting ADVENT...</span>
                                    </div>
                                    <div class="step" id="step-ready">
                                        <span class="step-icon">&#9675;</span>
                                        <span class="step-text">Ready to play!</span>
                                    </div>
                                </div>
                                <p class="wait-message" id="wait-message">Please wait while we connect you...</p>
                            </div>
                        </div>
                    </div>
                    <div class="crt-controls">
                        <div class="led power-led on"></div>
                        <span class="led-label">POWER</span>
                        <div class="led online-led" id="online-led"></div>
                        <span class="led-label">ONLINE</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right side: Status Panel -->
        <div class="status-panel">
            <div class="panel-header">
                <h1>ADVENT</h1>
                <h2><span class="crossed-out">Multi-User</span> Dungeon</h2>
                <p class="graffiti">single user</p>
                <p class="year">circa 1987</p>
            </div>

            <div class="info-box">
                <h3>About This System</h3>
                <p>You are connecting to a <strong>PDP-11</strong> emulator running <strong>RSTS/E V10.1</strong>, a timesharing operating system from Digital Equipment Corporation.</p>
                <p>The game is written in <strong>BASIC-PLUS-2</strong> and was originally created in 1987 at Manchester Grammar School.</p>
            </div>

            <div class="info-box commands">
                <h3>Game Commands</h3>
                <ul>
                    <li><span class="cmd">LOOK</span> - Examine surroundings</li>
                    <li><span class="cmd">N S E W</span> - Move around</li>
                    <li><span class="cmd">GET / DROP</span> - Handle items</li>
                    <li><span class="cmd">INVENTORY</span> - Your belongings</li>
                    <li><span class="cmd">STATUS</span> - Check your stats</li>
                    <li><span class="cmd">QUIT</span> - Exit game</li>
                </ul>
                <p class="status-link">
                    <a href="#" onclick="showDoc('STATUS.md')">View full feature status</a>
                    &nbsp;|&nbsp;
                    <a href="#" onclick="showMap()">Dungeon Map</a>
                </p>
            </div>

            <div class="info-box controls">
                <h3>Session Controls</h3>
                <button class="restart-btn" onclick="restartSession()">Restart PDP-11</button>
                <p class="help-text">Use if stuck or game becomes unresponsive</p>
            </div>

            <div class="info-box docs">
                <h3>Documentation</h3>
                <ul>
                    <li><a href="#" onclick="showDoc('RESURRECTION.md')">The Resurrection Story</a></li>
                    <li><a href="#" onclick="showDoc('PROVENANCE.md')">File Provenance</a></li>
                    <li><a href="#" onclick="showDoc('TECHNICAL.md')">Technical Details</a></li>
                    <li><a href="#" onclick="showDoc('NEWADV.md')">Dungeon Writers Guide (1987)</a></li>
                </ul>
            </div>

            <div class="footer">
                <p>Original: Edward Hibbert, David Quest &amp; others, 1987</p>
                <p>Resurrected: December 2025</p>
            </div>
        </div>
    </div>

    <!-- Full-screen modal for documentation -->
    <div id="doc-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="doc-title">Document</h2>
                <button class="modal-close" onclick="closeDoc()">&times;</button>
            </div>
            <div id="doc-body" class="modal-body">
                Loading...
            </div>
        </div>
    </div>

    <!-- Reboot confirmation modal -->
    <div id="reboot-modal" class="modal hidden">
        <div class="modal-content reboot-modal-content">
            <div class="modal-header">
                <h2>Reboot PDP-11?</h2>
            </div>
            <div class="modal-body reboot-body">
                <p>This will restart the RSTS/E operating system.</p>
                <p>The reboot takes approximately <strong>2 minutes</strong>.</p>
                <p class="reboot-warning">Any unsaved game progress will be lost.</p>
                <div class="reboot-buttons">
                    <button class="reboot-cancel" onclick="closeRebootModal()">Cancel</button>
                    <button class="reboot-confirm" onclick="confirmReboot()">Reboot</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Dungeon Map modal -->
    <div id="map-modal" class="modal hidden">
        <div class="modal-content map-modal-content">
            <div class="modal-header">
                <h2>Dungeon Map</h2>
                <button class="modal-close" onclick="closeMap()">&times;</button>
            </div>
            <div class="modal-body map-body">
                <div class="map-legend">
                    <span class="legend-item"><span class="legend-dot original"></span> Original connection</span>
                    <span class="legend-item"><span class="legend-dot reconstructed"></span> Reconstructed</span>
                    <span class="legend-item"><span class="legend-start"></span> Starting room</span>
                </div>
                <div class="map-controls">
                    <label>Room: <select id="room-select"><option value="">Loading...</option></select></label>
                    <button onclick="goToRoom(2)">Go to Start</button>
                </div>
                <div class="map-room" id="map-room">
                    <div class="room-number" id="room-number"></div>
                    <div class="room-description" id="room-description"></div>
                    <div class="room-exits" id="room-exits"></div>
                </div>
                <div class="map-stats" id="map-stats"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="terminal.js"></script>
    <script src="map.js"></script>
</body>
</html>
